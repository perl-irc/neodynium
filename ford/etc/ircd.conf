/* IMPORTANT NOTES:
 *
 * class {} blocks MUST be specified before anything that uses them.  That
 * means they must be defined before auth {} and before connect {}.
 *
 * auth {} blocks MUST be specified in order of precedence.  The first one
 * that matches a user will be used.  So place spoofs first, then specials,
 * then general access, then restricted.
 *
 * Both shell style (#) and C style comments are supported.
 *
 * Files may be included by either:
 *        .include "filename"
 *        .include <filename>
 *
 * Times/durations are written as:
 *        12 hours 30 minutes 1 second
 *        
 * Valid units of time:
 *        month, week, day, hour, minute, second
 *
 * Valid units of size:
 *        megabyte/mbyte/mb, kilobyte/kbyte/kb, byte
 *
 * Sizes and times may be singular or plural.  
 */ 

serverinfo {
	name = "ford.tamarou.com";
	description = "Home of the Drama Llamas";
	network_name = "MAGnet";
	network_desc = "Reasonable Person Principle required. (http://www.irc.perl.org/rules.html)";
	hub = yes;
	max_clients = 2048;
	rsa_private_key_file = "/usr/local/ircd/etc/ssl/rsa.key";
	ssl_certificate_file = "/usr/local/ircd/etc/ssl/cert.pem";

	/* rsa key: the path to the file containing our rsa key for cryptlink.
	 *
	 * Example command to store a 2048 bit RSA keypair in
	 * rsa.key, and the public key in rsa.pub:
	 * 
	 * openssl genrsa -out rsa.key 2048
	 * openssl rsa -in rsa.key -pubout -out rsa.pub
	 * chown <ircd-user>.<ircd.group> rsa.key rsa.pub
	 * chmod 0600 rsa.key
	 * chmod 0644 rsa.pub
	 * openssl req -new -x509 -key rsa.key -out cert.pem
	 */
};


admin {
	name = "perigrin";
	description = "perigrin";
	email = "chris@prather.org";
};


log {
	/* log level: the amount of detail to log in ircd.log.  The
	 * higher, the more information is logged.  May be changed
	 * once the server is running via /quote SET LOG.  Either:
	 * L_CRIT, L_ERROR, L_WARN, L_NOTICE, L_TRACE, L_INFO or L_DEBUG
	 */
	use_logging = yes;

	log_level = L_INFO;
	fname_userlog = "/usr/local/ircd/logs/user.log";
	fname_operlog = "/usr/local/ircd/logs/oper.log";
	fname_glinelog = "/usr/local/ircd/logs/gline.log";
	fname_klinelog = "/usr/local/ircd/logs/kline.log";
	fname_killlog = "/usr/local/ircd/logs/kill.log";
};


class {
	name = "users";
	ping_time = 3 minutes;
	number_per_ip = 10;
	max_number = 2048;
	sendq = 60kbytes;
};

class {
	name = "restricted";
	ping_time = 1 minute 30 seconds;
	number_per_ip = 5;
	max_number = 100;
	sendq = 60kbytes;
};

class {
	name = "unrestricted";
	ping_time = 2 minutes;
	number_per_ip = 10;
	max_number = 1024;
	sendq = 60kbytes;
};

class {
	name = "opers";
	ping_time = 5 minutes;
	number_per_ip = 15;
	max_number = 100;
	sendq = 100kbytes;
};

class {
	name = "server";
	ping_time = 4 minutes;
	connectfreq = 3 minutes;
	max_number = 10;
	sendq=2 megabytes;
};



listen {
/* 	host = "0.0.0.0"; */
	port = 6667;

	flags = ssl;
	port = 7062;

	host = "2600:3c00::f03c:91ff:fedb:bf01"; 
	port = 6667;

	flags = ssl;
	port = 7062;
};



.include </usr/local/ircd/etc/vanity.conf>
.include </usr/local/ircd/etc/bopm.include>
.include </usr/local/ircd/etc/opers.conf>



auth {
	user = "*@*";
	class = "users";
	#restricted = yes;
	have_ident = no;
};




channel {
	use_invex = yes;
	use_except = yes;

	use_knock = yes;
	knock_delay = 5 minutes;
	knock_delay_channel = 1 minute;

	max_chans_per_user = 100;

	quiet_on_ban = yes;
	max_bans = 100;

	default_split_user_count = 0;
	default_split_server_count = 0;
	no_create_on_split = no;
	no_join_on_split = no;

};


serverhide {
	flatten_links = yes;
	links_delay = 5 minutes;
	hidden = yes;
	disable_hidden = no;
	hide_servers = yes;
	hidden_name = "irc.perl.org";
};



general {
	default_floodcount = 5;
	failed_oper_notice = yes;
	dots_in_ident=2;
	dot_in_ip6_addr = no;
	min_nonwildcard = 4;
	max_accept = 20;
	anti_nick_flood = yes;
	max_nick_time = 20 seconds;
	max_nick_changes = 5;
	anti_spam_exit_message_time = 5 minutes;
	ts_warn_delta = 30 seconds;
	ts_max_delta = 5 minutes;
	kline_with_reason = yes;
	warn_no_nline = yes;
	stats_o_oper_only=yes;
	stats_P_oper_only=no;
	stats_i_oper_only=yes;
	stats_k_oper_only=yes;
	caller_id_wait = 1 minute;
	pace_wait_simple = 1 second;
	pace_wait = 10 seconds;
	short_motd = no;
	ping_cookie = no;
	no_oper_flood = yes;
	true_no_oper_flood = yes;
	idletime = 0;
	max_targets = 4;
	client_flood = 10;
	throttle_time = 10;
	message_locale = "custom";

	/* usermodes configurable: a list of usermodes for the options below
	 *
	 * +b - bots       - See bot and drone flooding notices
	 * +c - cconn      - Client connection/quit notices
	 * +d - debug      - See debugging notices
	 * +f - full       - See I: line full notices
	 * +g - callerid   - Server Side Ignore
	 * +i - invisible  - Not shown in NAMES or WHO unless you share a 
	 *                   a channel
	 * +k - skill      - See server generated KILL messages
	 * +l - locops     - See LOCOPS messages
	 * +n - nchange    - See client nick changes
	 * +r - rej        - See rejected client notices
	 * +s - servnotice - See general server notices
	 * +u - unauth     - See unauthorized client notices
	 * +w - wallop     - See server generated WALLOPS
	 * +x - external   - See remote server connection and split notices
	 * +y - spy        - See LINKS, STATS, TRACE notices etc.
	 * +z - operwall   - See oper generated WALLOPS
	 */
	 
	/* oper only umodes: usermodes only opers may set */
	oper_only_umodes = bots, cconn, debug, full, skill, nchange, 
                     rej, spy, external, operwall, locops, unauth;

	/* oper umodes: default usermodes opers get when they /oper */
	oper_umodes = locops, servnotice, operwall, wallop, full;


	use_whois_actually = no;
};

glines {
	enable = yes;
	duration = 7 day;
	logging = reject, block;
};


modules {
	/* module path: paths to search for modules specified below and 
	 * in /modload.
	 */
	path = "/usr/local/ircd/modules";
	path = "/usr/local/ircd/modules/autoload";

	/* module: the name of a module to load on startup/rehash */
	#module = "some_module.so";
};

.include </usr/local/ircd/etc/servers/spectral.shadowcat.co.uk.conf>
.include </usr/local/ircd/etc/servers/astral.shadowcat.co.uk.conf>

shared { name = "services.irc.perl.org"; type = all; };
